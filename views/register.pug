doctype html
html
  head
    meta(charset='utf-8')
    meta(name='viewport' content='width=device-width, initial-scale=1')
    title Register â€” My Grocery Buddy
    link(rel='stylesheet' href='/css/style.css')
    link(rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css")
    link(rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css")
  body
    // Header
    header
      h1 ðŸ›’ My Grocery List
      .header-actions(style="display:flex; align-items:center; gap:20px;")
        form(action="/" method="GET" style="margin:0;")
          button.logout-btn(type="submit") Logout

    // Register Page
    form#registerPage.center.needs-validation(novalidate method='POST' action='/api/auth/register')
      .card
        h2 Create Grocery Account ðŸ›’
        input#regUsername(type='text' name='username' placeholder='Username' required)
        div.invalid-feedback Please enter a username.

        input#regEmail(type='email' name='email' placeholder='Email' required)
        div.invalid-feedback Please enter a valid email.

        // Password input with toggle eye
        .password-wrapper(style="position:relative;")
          input#regPassword(type='password' name='password' placeholder='Password' required)
          span#togglePassword1.toggle-password(data-input='regPassword', style="position:absolute; right:10px; top:50%; transform:translateY(-50%); cursor:pointer;")
            i(class="fa fa-eye")
          div.invalid-feedback Please enter a password.

        // Confirm Password input with toggle eye
        .password-wrapper(style="position:relative; margin-top:10px;")
          input#regConfirmPassword(type='password' name='confirmPassword' placeholder='Confirm Password' required)
          span#togglePassword2.toggle-password(data-input='regConfirmPassword', style="position:absolute; right:10px; top:50%; transform:translateY(-50%); cursor:pointer;")
            i(class="fa fa-eye")
          div.invalid-feedback Passwords do not match.

        button#registerBtn(type='submit') Register
        p
          | Already have an account?
          a#showLogin(href='/login') Login

    script(src='/js/app.js')
    script.
      // Bootstrap validation
      (function () {
        'use strict';
        const forms = document.querySelectorAll('.needs-validation');
        Array.from(forms).forEach(function (form) {
          form.addEventListener('submit', function (event) {
            const password = form.querySelector('#regPassword');
            const confirmPassword = form.querySelector('#regConfirmPassword');
            if (confirmPassword && password.value !== confirmPassword.value) {
              confirmPassword.setCustomValidity("Passwords do not match");
            } else if (confirmPassword) {
              confirmPassword.setCustomValidity("");
            }

            if (!form.checkValidity()) {
              event.preventDefault();
              event.stopPropagation();
            }
            form.classList.add('was-validated');
          }, false);
        });
      })();
